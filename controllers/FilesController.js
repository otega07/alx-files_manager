/* eslint-disable import/no-named-as-default */
/* eslint-disable no-unused-vars */
const { tmpdir } = require('os');
const { promisify } = require('util');
const Queue = require('bull/lib/queue');
const { v4: uuidv4 } = require('uuid');
const {
  mkdir, writeFile, stat, existsSync, realpath
} = require('fs');
const { join: joinPath } = require('path');
const { contentType } = require('mime-types');
const mongoDBCore = require('mongodb/lib/core');
const dbClient = require('../utils/db');
const { getUserFromXToken } = require('../utils/auth');

const VALID_FILE_TYPES = {
  folder: 'folder',
  file: 'file',
  image: 'image',
};
const ROOT_FOLDER_ID = 0;
const DEFAULT_ROOT_FOLDER = 'files_manager';
const mkDirAsync = promisify(mkdir);
const writeFileAsync = promisify(writeFile);
const statAsync = promisify(stat);
const realpathAsync = promisify(realpath);
const MAX_FILES_PER_PAGE = 20;
const fileQueue = new Queue('thumbnail generation');
const NULL_ID = Buffer.alloc(24, '0').toString('utf-8');
const isValidId = (id) => {
  const size = 24;
  let i = 0;
  const charRanges = [
    [48, 57], // 0 - 9
    [97, 102], // a - f
    [65, 70], // A - F
  ];
  if (typeof id !== 'string' || id.length !== size) {
    return false;
  }
  while (i < size) {
    const c = id[i];
    const code = c.charCodeAt(0);

    if (!charRanges.some((range) => code >= range[0] && code <= range[1])) {
      return false;
    }
    i += 1;
  }
  return true;
};

class FilesController {
  static async postUpload(req, res) {
    const { user } = req;
    const name = req.body ? req.body.name : null;
    const type = req.body ? req.body.type : null;
    const parentId = req.body && req.body.parentId ? req.body.parentId : ROOT_FOLDER_ID;
    const isPublic = req.body && req.body.isPublic ? req.body.isPublic : false;
    const base64Data = req.body && req.body.data ? req.body.data : '';

    // ... rest of the code remains the same
  }
  
  // ... other methods remain unchanged
}

module.exports = FilesController;
